<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–î–ª—è —Ç–µ–±—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --pink: #f4a6c4;
      --pink-soft: #ffd1e5;
      --dark: #2b1b27;
      --bg: #fff3fa;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      padding: 18px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #ffe4f3, #ffd1dc 40%, #fff7fb 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--dark);
      overflow-x: hidden;
    }

    .wrapper {
      width: 100%;
      max-width: 480px;
      position: relative;
      z-index: 1;
    }

    /* –õ–µ—Ç–∞—é—â–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏ */
    .hearts {
      position: fixed;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
      z-index: 0;
    }

    .hearts span {
      position: absolute;
      font-size: 20px;
      opacity: 0.35;
      animation: floatUp 14s linear infinite;
      color: #ffbfd6;
    }

    .hearts span:nth-child(1) { left: 10%; animation-delay: 0s; font-size: 22px;}
    .hearts span:nth-child(2) { left: 30%; animation-delay: 3s; font-size: 18px;}
    .hearts span:nth-child(3) { left: 55%; animation-delay: 6s; font-size: 26px;}
    .hearts span:nth-child(4) { left: 75%; animation-delay: 1s; font-size: 20px;}
    .hearts span:nth-child(5) { left: 90%; animation-delay: 4s; font-size: 16px;}

    @keyframes floatUp {
      0%   { transform: translateY(100vh); opacity: 0; }
      15%  { opacity: 0.4; }
      85%  { opacity: 0.4; }
      100% { transform: translateY(-10vh); opacity: 0; }
    }

    .card {
      background: rgba(255, 255, 255, 0.93);
      border-radius: 22px;
      padding: 24px 22px 26px;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.16);
      backdrop-filter: blur(10px);
      position: relative;
      z-index: 2;
    }

    .title-main {
      margin: 0 0 4px;
      font-size: 24px;
      font-weight: 650;
    }

    .subtitle {
      margin: 0;
      font-size: 14px;
      opacity: 0.8;
    }

    .heart-big {
      font-size: 30px;
      margin-bottom: 6px;
      animation: beat 1.4s infinite;
    }

    @keyframes beat {
      0%,40%,80%,100% { transform: scale(1); }
      20%,60%         { transform: scale(1.2); }
    }

    .input-row {
      margin-top: 18px;
    }

    label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      opacity: 0.85;
    }

    input[type="password"] {
      width: 100%;
      padding: 11px 13px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,0.12);
      font-size: 15px;
      outline: none;
      background: #fff;
      transition: border-color 0.2s, box-shadow 0.2s, transform 0.1s;
    }

    input[type="password"]:focus {
      border-color: var(--pink);
      box-shadow: 0 0 0 2px rgba(244,166,196,0.25);
      transform: translateY(-1px);
    }

    .btn {
      margin-top: 14px;
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 11px 14px;
      background: linear-gradient(135deg, #ff9fc9, #ff6b9d);
      color: #fff;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(255, 84, 150, 0.35);
      transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.1s;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 32px rgba(255, 84, 150, 0.4);
      filter: brightness(1.02);
    }

    .btn:active {
      transform: translateY(0);
      box-shadow: 0 8px 18px rgba(255, 84, 150, 0.35);
      filter: brightness(0.98);
    }

    .hint {
      margin-top: 8px;
      font-size: 12px;
      opacity: 0.7;
    }

    .error {
      margin-top: 8px;
      font-size: 12px;
      color: #e14c65;
      min-height: 16px;
    }

    .center {
      text-align: center;
    }

    .hidden {
      display: none;
    }

    .shake {
      animation: shake 0.4s;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-6px); }
      40% { transform: translateX(6px); }
      60% { transform: translateX(-4px); }
      80% { transform: translateX(4px); }
    }

    /* –≠–∫—Ä–∞–Ω –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è */

    .invite-card {
      opacity: 0;
      transform: translateY(24px) scale(0.96);
    }

    body.invite-visible .invite-card {
      animation: showCard 0.75s cubic-bezier(.16,.82,.29,1) forwards;
    }

    @keyframes showCard {
      0% {
        opacity: 0;
        transform: translateY(24px) scale(0.96);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .tag-row {
      margin: 14px 0 6px;
    }

    .tag {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(238, 156, 167, 0.14);
      margin-right: 6px;
      margin-top: 4px;
    }

    .rows {
      font-size: 14px;
      margin-top: 6px;
    }

    .row {
      margin: 7px 0;
      display: flex;
      align-items: baseline;
      gap: 4px;
    }

    .label {
      font-weight: 600;
      min-width: 86px;
    }

    a {
      color: #c04c72;
      text-decoration: none;
      border-bottom: 1px dashed rgba(192,76,114,0.6);
    }

    a:hover {
      border-bottom-style: solid;
    }

    .note {
      margin-top: 12px;
      font-size: 13px;
      opacity: 0.9;
    }

    .divider {
      margin: 16px 0 14px;
      border: none;
      border-top: 1px dashed rgba(0,0,0,0.18);
    }

    .tasks {
      font-size: 13px;
    }

    .tasks b {
      font-weight: 600;
    }

    .tiny {
      font-size: 11px;
      opacity: 0.7;
      margin-top: 4px;
    }

    /* –û–î–ù–û –¶–ï–ù–¢–†–ê–õ–¨–ù–û–ï –§–û–¢–û */

    .photos {
      margin-top: 10px;
    }

    .photos h3 {
      margin: 0 0 10px;
      font-size: 15px;
      font-weight: 600;
      text-align: center;
    }

    .photo-main {
      display: flex;
      justify-content: center;
      margin: 12px 0 4px;
    }

    .photo-frame-main {
      position: relative;
      background: #fff;
      padding: 10px 10px 14px;
      border-radius: 22px;
      border: 2px solid var(--pink-soft);
      box-shadow: 0 12px 28px rgba(0,0,0,0.18);
      width: 80%;
      max-width: 340px;
      opacity: 0;
      transform: translateY(18px) scale(0.94);
    }

    .photo-frame-main img {
      width: 100%;
      display: block;
      border-radius: 18px;
      max-height: 360px;
      object-fit: cover;
    }

    .photo-frame-main::before {
      content: "";
      position: absolute;
      width: 46%;
      height: 14px;
      background: rgba(255,255,255,0.9);
      top: -6px;
      left: 50%;
      transform: translateX(-50%) rotate(-2deg);
      border-radius: 4px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.18);
    }

    body.invite-visible .photo-frame-main {
      animation: mainPhotoIn 0.7s ease-out forwards;
      animation-delay: 0.35s;
    }

    @keyframes mainPhotoIn {
      0% { opacity: 0; transform: translateY(18px) scale(0.94); }
      100%{ opacity: 1; transform: translateY(0) scale(1); }
    }

    @media (max-width: 360px) {
      .card {
        padding: 20px 16px 22px;
      }
    }
  </style>
</head>
<body>
  <audio id="bg-music" src="music.mp3" preload="auto" loop></audio>
  <div class="hearts">
    <span>‚ô•</span><span>‚ô•</span><span>‚ô•</span><span>‚ô•</span><span>‚ô•</span>
  </div>

  <div class="wrapper">

    <!-- –≠–ö–†–ê–ù –ü–ê–†–û–õ–Ø -->
    <div id="password-screen" class="card">
      <div class="center">
        <div class="heart-big">‚ù§Ô∏è</div>
        <h1 class="title-main">–ù–µ–±–æ–ª—å—à–æ–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —Å–∞–π—Ç</h1>
        <p class="subtitle">–û–Ω –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–º—É, –∫—Ç–æ –∑–Ω–∞–µ—Ç –æ–¥–Ω—É –≤–∞–∂–Ω—É—é –¥–∞—Ç—É</p>
      </div>

      <div class="input-row">
        <label for="password-input">–ü–∞—Ä–æ–ª—å</label>
        <input id="password-input" type="password" autocomplete="off" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
        <button id="password-button" class="btn">–û—Ç–∫—Ä—ã—Ç—å</button>
        <div id="password-error" class="error"></div>
        <div class="hint">
          –ü–æ–¥—Å–∫–∞–∑–∫–∞: –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –¥–∞—Ç–∞, –∑–∞–ø–∏—Å–∞–Ω–Ω–∞—è –∫–∞–∫ <b>–î–î–ú–ú–ì–ì</b> –±–µ–∑ —Ç–æ—á–µ–∫ ‚ú®
        </div>
      </div>
    </div>

    <!-- –≠–ö–†–ê–ù –ü–†–ò–ì–õ–ê–®–ï–ù–ò–Ø -->
    <div id="invite-screen" class="hidden">
      <div class="card invite-card">
        <div class="center">
          <div class="heart-big">üíå</div>
          <h1 class="title-main">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ —Å–≤–∏–¥–∞–Ω–∏–µ</h1>
          <p class="subtitle">–≠—Ç–æ—Ç –≤–µ—á–µ—Ä —è —Ö–æ—á—É –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ —Å —Ç–æ–±–æ–π</p>
        </div>

        <div class="tag-row center">
          <span class="tag">–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ö–æ–¥ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω</span>
          <span class="tag">–¢–æ–ª—å–∫–æ –º—ã –¥–≤–æ–µ</span>
        </div>

        <div class="rows">
          <div class="row">
            <span class="label">–î–∞—Ç–∞:</span>
            <span>12.12.2025</span>
          </div>
          <div class="row">
            <span class="label">–ú–µ—Å—Ç–æ:</span>
            <span>Bella Ciao, –∏—Ç–∞–ª—å—è–Ω—Å–∫–∞—è —Ç—Ä–∞—Ç—Ç–æ—Ä–∏—è</span>
          </div>
          <div class="row">
            <span class="label">–ê–¥—Ä–µ—Å:</span>
            <span>
              <a href="https://2gis.kz/almaty/inside/70030076572816822/firm/70000001089490010?m=76.932159%2C43.26335%2F19.25%2Fp%2F47.19%2Fr%2F-88.72" target="_blank">
                –æ—Ç–∫—Ä—ã—Ç—å –≤ 2GIS
              </a>
            </span>
          </div>
          <div class="row">
            <span class="label">–î—Ä–µ—Å—Å‚Äë–∫–æ–¥:</span>
            <span>–õ—é–±–æ–µ - —Ç—ã –≤—Å–µ–≥–¥–∞ —Å—É–ø–µ—Ä –∫—Ä–∞—Å–∏–≤–∞—è</span>
          </div>
          <div class="row">
            <span class="label">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:</span>
            <span>–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ</span>
          </div>
          <div class="row">
            <span class="label">–£—Ä–æ–≤–µ–Ω—å –ª—é–±–≤–∏:</span>
            <span>–ó–∞–ø—Ä–µ–¥–µ–ª—å–Ω—ã–π ‚ôæÔ∏è</span>
          </div>
          <div class="row">
            <span class="label">–í—Ä–µ–º—è:</span>
            <span>19:00</span>
          </div>
        </div>


        <div class="tasks" id="countdown-block">
          <p><b>–î–æ –Ω–∞—à–µ–≥–æ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –æ—Å—Ç–∞–ª–æ—Å—å:</b></p>
          <p>
            <b id="cd-d">‚Äî</b> –¥–Ω–µ–π
            <b id="cd-h">‚Äî</b> —á–∞—Å–æ–≤
            <b id="cd-m">‚Äî</b> –º–∏–Ω—É—Ç
            <b id="cd-s">‚Äî</b> —Å–µ–∫—É–Ω–¥
          </p>
        </div>

        <div class="tasks" id="letter-block">
          <p><b>–ü–∏—Å—å–º–æ –Ω–∞ —Å–Ω–µ–∂–∏–Ω–∫–µ</b> <span class="tiny" id="typing-status"></span></p>
          <p id="typewriter"></p>
        </div>

        <hr class="divider">

        <div class="tasks">
          <p><b>–¢–≤–æ—è –∑–∞–¥–∞—á–∞:</b> –æ—Ç–ø—Ä–æ—Å–∏—Ç—å—Å—è, –≤–∫—É—Å–Ω–æ –ø–æ–∫—É—à–∞—Ç—å –∏ –ø–æ–≥—É–ª—è—Ç—å.</p>
          <p><b>–ú–æ—è –∑–∞–¥–∞—á–∞:</b> –∑–∞–±—Ä–∞—Ç—å —Ç–µ–±—è, –Ω–∞–∫–æ—Ä–º–∏—Ç—å –∏ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç –≤–µ—á–µ—Ä –æ—Å–æ–±–µ–Ω–Ω—ã–º.</p>
        </div>

        <p class="note">
          –ï—Å–ª–∏ —Ç—ã –≤–∏–¥–∏—à—å —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—á–∫—É, –∑–Ω–∞—á–∏—Ç –∫—Ç–æ‚Äë—Ç–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –∂–¥—ë—Ç –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏
          –∏ –∑–∞—Ä–∞–Ω–µ–µ —É–ª—ã–±–∞–µ—Ç—Å—è, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è —ç—Ç–æ—Ç –≤–µ—á–µ—Ä —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π üíó
        </p>


        <div class="tasks" id="gift-block">
          <p><b>üéÅ –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Å—é—Ä–ø—Ä–∏–∑</b></p>
          <p class="tiny">–ù–∞–∂–º–∏ ‚Äî –∏ —è –ø–æ–∫–∞–∂—É –º–∞–ª–µ–Ω—å–∫–æ–µ –æ–±–µ—â–∞–Ω–∏–µ –Ω–∞ –Ω–∞—à –≤–µ—á–µ—Ä.</p>
          <button id="gift-btn" class="btn" type="button">–û—Ç–∫—Ä—ã—Ç—å</button>

          <div id="surprise" class="hidden">
            <p><b id="surprise-title"></b></p>
            <p id="surprise-text"></p>
            <p class="tiny">–ú–æ–∂–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å —Å–Ω–æ–≤–∞ ‚Äî —Å—é—Ä–ø—Ä–∏–∑—ã –º–µ–Ω—è—é—Ç—Å—è üòâ</p>
          </div>
        </div>

        <div class="tasks" id="checklist-block">
          <p><b>‚ú® –ù–∞—à –º–∏–Ω–∏‚Äë–ø–ª–∞–Ω</b></p>

          <div class="row">
            <input type="checkbox" data-key="walk">
            <span>
              –ü—Ä–æ–≥—É–ª–∫–∞ –ø–æ–¥ –æ–≥–æ–Ω—å–∫–∞–º–∏<br>
              <span class="tiny">10 –º–∏–Ω—É—Ç –∏–ª–∏ 2 —á–∞—Å–∞ ‚Äî –∫–∞–∫ –∑–∞—Ö–æ—á–µ—Ç—Å—è.</span>
            </span>
          </div>

          <div class="row">
            <input type="checkbox" data-key="toast">
            <span>
              –¢–æ—Å—Ç –∑–∞ –Ω–∞—Å<br>
              <span class="tiny">–∑–∞ –≤—Å—ë —Ö–æ—Ä–æ—à–µ–µ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –∏ —á—Ç–æ –µ—â—ë –±—É–¥–µ—Ç.</span>
            </span>
          </div>

          <div class="row">
            <input type="checkbox" data-key="hug">
            <span>
              –°–∞–º—ã–µ —Ç—ë–ø–ª—ã–µ –æ–±—ä—è—Ç–∏—è<br>
              <span class="tiny">–Ω–µ –æ–±—Å—É–∂–¥–∞–µ—Ç—Å—è üíó</span>
            </span>
          </div>
        </div>

        <div class="photos">

          <div class="photo-main">
            <figure class="photo-frame-main">
              <img src="photo1.jpg" alt="–ù–∞—à –º–æ–º–µ–Ω—Ç">
            </figure>
          </div>

          <div class="tiny">
            –ò —ç—Ç–æ —Ç–æ–ª—å–∫–æ –º–∞–ª–µ–Ω—å–∫–∞—è —á–∞—Å—Ç—å —Ç–æ–≥–æ, –∫–∞–∫ –∫—Ä–∞—Å–∏–≤–æ –º—ã —Å–º–æ—Ç—Ä–∏–º—Å—è –≤–º–µ—Å—Ç–µ.
            –û—Å—Ç–∞–ª—å–Ω–æ–µ —Ö–æ—á—É —É–≤–∏–¥–µ—Ç—å –≤–∂–∏–≤—É—é –≤ —Ç–æ—Ç –≤–µ—á–µ—Ä üåô
          </div>
        </div>

      </div>
    </div>
  </div>
  <script>
  (function () {
    const PASS = "090925"
    const EVENT_ISO = "2025-12-12T19:00:00"

    const LETTER_TEXT =
      "–°–ø–∞—Å–∏–±–æ –±–æ–ª—å—à–æ–µ —á—Ç–æ —Ç—ã –µ—Å—Ç—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏,\n" +
      "–±–æ–ª—å—à–µ —Å–º–µ—Ö–∞, –±–æ–ª—å—à–µ –ø—Ä–æ–≥—É–ª–æ–∫ –ø–æ–¥ –æ–≥–æ–Ω—å–∫–∞–º–∏ –∏ –±–æ–ª—å—à–µ ¬´–¥–∞–≤–∞–π –µ—â—ë 5 –º–∏–Ω—É—Ç¬ª.\n\n" +
      "–õ—é–±–ª—é —Ç–µ–±—èüíó\n"

    const SURPRISES = [
      { title: "–ì–æ—Ä—è—á–∏–π —à–æ–∫–æ–ª–∞–¥ ‚òï", text: "–° –º–µ–Ω—è - –≥–æ—Ä—è—á–∏–π —à–æ–∫–æ–ª–∞–¥ (–∏–ª–∏ —á—Ç–æ —Ç—ã –∑–∞—Ö–æ—á–µ—à—å), —á—Ç–æ–±—ã –±—ã–ª–æ —Å–æ–≤—Å–µ–º –ø–æ‚Äë–∑–∏–º–Ω–µ–º—É." },
      { title: "–ü—Ä–æ–≥—É–ª–∫–∞ –ø–æ–¥ –æ–≥–æ–Ω—å–∫–∞–º–∏ ‚ú®", text: "–ù–∞–π–¥—ë–º —Å–∞–º—ã–µ –∫—Ä–∞—Å–∏–≤—ã–µ –≥–∏—Ä–ª—è–Ω–¥—ã –∏ —Å–¥–µ–ª–∞–µ–º –ø–∞—Ä—É –º–∏–ª—ã—Ö —Ñ–æ—Ç–æ (–∏ –ø–∞—Ä—É —Å–æ–≤—Å–µ–º –Ω–µ—Å–µ—Ä—å—ë–∑–Ω—ã—Ö üòÑ)." },
      { title: "–¢—ë–ø–ª—ã–µ —Ä—É–∫–∏ ü§ç", text: "–ï—Å–ª–∏ –≤–¥—Ä—É–≥ –±—É–¥–µ—Ç —Ö–æ–ª–æ–¥–Ω–æ - —É –º–µ–Ω—è –µ—Å—Ç—å –ø–ª–∞–Ω: –¥–µ—Ä–∂–∞—Ç—å —Ç–µ–±—è –∑–∞ —Ä—É–∫—É –∏ –Ω–µ –æ—Ç–ø—É—Å–∫–∞—Ç—å." },
      { title: "–¢–æ—Å—Ç –∑–∞ –Ω–∞—Å ü•Ç", text: "–ó–∞ —Ç–æ, —á—Ç–æ–±—ã —É –Ω–∞—Å –±—ã–ª–æ –±–æ–ª—å—à–µ –ø–æ–≤–æ–¥–æ–≤ —É–ª—ã–±–∞—Ç—å—Å—è - –≤–º–µ—Å—Ç–µ." },
      { title: "–ü–µ—Å–Ω—è –≤–µ—á–µ—Ä–∞ üé∂", text: "–í—ã–±–∏—Ä–∞–µ—à—å —Ç—ã. –ò –æ–Ω–∞ –±—É–¥–µ—Ç –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞—Ç—å—Å—è —É –º–µ–Ω—è —Å —Ç–æ–±–æ–π." }
    ]

    const STORAGE_KEY = "ny_romantic_checklist_v1"

    const input = document.getElementById("password-input")
    const button = document.getElementById("password-button")
    const error = document.getElementById("password-error")
    const passScreen = document.getElementById("password-screen")
    const inviteScreen = document.getElementById("invite-screen")
    const audio = document.getElementById("bg-music")

    const cdD = document.getElementById("cd-d")
    const cdH = document.getElementById("cd-h")
    const cdM = document.getElementById("cd-m")
    const cdS = document.getElementById("cd-s")

    const typeEl = document.getElementById("typewriter")
    const typingStatus = document.getElementById("typing-status")

    const giftBtn = document.getElementById("gift-btn")
    const surpriseBox = document.getElementById("surprise")
    const surpriseTitle = document.getElementById("surprise-title")
    const surpriseText = document.getElementById("surprise-text")

    let unlocked = false
    let countdownTimerId = null

    function trimValue(raw) {
      return String(raw || "").replace(/^\s+|\s+$/g, "")
    }

    // –ú—É–∑—ã–∫–∞ (–∫–∞–∫ –≤ —Ç–≤–æ—ë–º —Ñ–∞–π–ª–µ ‚Äî —Å –ø–ª–∞–≤–Ω—ã–º –ø–æ—è–≤–ª–µ–Ω–∏–µ–º –≥—Ä–æ–º–∫–æ—Å—Ç–∏)
    function startMusic() {
      if (!audio) {
        return
      }

      let current = 0
      audio.volume = 0

      function fade() {
        const step = 1 / 20
        const id = setInterval(function () {
          current = current + step
          if (current >= 1) {
            current = 1
            clearInterval(id)
          }
          audio.volume = current
        }, 250)
      }

      const playPromise = audio.play()
      if (playPromise && playPromise.then) {
        playPromise.then(function () {
          fade()
        }).catch(function () {})
      } else {
        fade()
      }
    }

    // ===== –¢–∞–π–º–µ—Ä =====
    function pad2(n) {
      n = Math.max(0, n)
      return (n < 10 ? "0" : "") + String(n)
    }

    function updateCountdown() {
      if (!cdD || !cdH || !cdM || !cdS) {
        return
      }

      const target = new Date(EVENT_ISO)
      const now = new Date()
      let diff = target.getTime() - now.getTime()

      if (isNaN(target.getTime())) {
        cdD.textContent = "‚Äî"
        cdH.textContent = "‚Äî"
        cdM.textContent = "‚Äî"
        cdS.textContent = "‚Äî"
        return
      }

      if (diff <= 0) {
        cdD.textContent = "0"
        cdH.textContent = "00"
        cdM.textContent = "00"
        cdS.textContent = "00"
        return
      }

      const sec = Math.floor(diff / 1000)
      const d = Math.floor(sec / (3600 * 24))
      const h = Math.floor((sec % (3600 * 24)) / 3600)
      const m = Math.floor((sec % 3600) / 60)
      const s = Math.floor(sec % 60)

      cdD.textContent = String(d)
      cdH.textContent = pad2(h)
      cdM.textContent = pad2(m)
      cdS.textContent = pad2(s)
    }

    function startCountdown() {
      updateCountdown()
      if (countdownTimerId) {
        clearInterval(countdownTimerId)
      }
      countdownTimerId = setInterval(updateCountdown, 1000)
    }

    // ===== –ü–∏—Å—å–º–æ (typewriter) =====
    function typewriter(text) {
      if (!typeEl) {
        return
      }

      // –æ—á–∏—Å—Ç–∫–∞
      while (typeEl.firstChild) {
        typeEl.removeChild(typeEl.firstChild)
      }

      if (typingStatus) {
        typingStatus.textContent = ""
      }

      let i = 0
      const id = setInterval(function () {
        const ch = text.charAt(i)

        if (ch === "\n") {
          typeEl.appendChild(document.createElement("br"))
        } else {
          typeEl.appendChild(document.createTextNode(ch))
        }

        i = i + 1

        if (i >= text.length) {
          clearInterval(id)
          if (typingStatus) {
            typingStatus.textContent = ""
          }
        }
      }, 22)
    }

    // ===== –°—é—Ä–ø—Ä–∏–∑ =====
    function openGift() {
      if (!surpriseBox || !surpriseTitle || !surpriseText) {
        return
      }

      const item = SURPRISES[Math.floor(Math.random() * SURPRISES.length)]
      surpriseTitle.textContent = item.title
      surpriseText.textContent = item.text
      surpriseBox.classList.remove("hidden")
    }

    if (giftBtn) {
      giftBtn.addEventListener("click", openGift)
    }

    // ===== –ß–µ–∫–ª–∏—Å—Ç (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º) =====
    function loadChecklist() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY)
        if (!raw) {
          return {}
        }
        return JSON.parse(raw) || {}
      } catch (e) {
        return {}
      }
    }

    function saveChecklist(obj) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(obj))
      } catch (e) {}
    }

    function initChecklist() {
      const saved = loadChecklist()
      const boxes = document.querySelectorAll('input[type="checkbox"][data-key]')

      boxes.forEach(function (cb) {
        const key = cb.getAttribute("data-key")
        cb.checked = !!saved[key]

        cb.addEventListener("change", function () {
          const now = loadChecklist()
          now[key] = cb.checked
          saveChecklist(now)
        })
      })
    }

    // ===== –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ =====
    function unlock() {
      if (unlocked) {
        return
      }

      const raw = (input && input.value) ? input.value : ""
      const value = trimValue(raw)

      if (value === PASS) {
        unlocked = true

        if (error) {
          error.textContent = ""
        }
        if (passScreen) {
          passScreen.classList.add("hidden")
        }
        if (inviteScreen) {
          inviteScreen.classList.remove("hidden")
        }

        document.body.classList.add("invite-visible")
        window.scrollTo({ top: 0, behavior: "smooth" })

        startMusic()
        startCountdown()
        typewriter(LETTER_TEXT)
        initChecklist()
      } else {
        if (error) {
          error.textContent = "–ü–æ—á—Ç–∏, –Ω–æ –Ω–µ—Ç! –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ üíï"
        }
        if (passScreen) {
          passScreen.classList.add("shake")
          setTimeout(function () {
            passScreen.classList.remove("shake")
          }, 450)
        }
      }
    }

    if (button) {
      button.addEventListener("click", unlock)
    }
    if (input) {
      input.addEventListener("keydown", function (e) {
        if (e.key === "Enter") {
          unlock()
        }
      })
    }
  })()
</script>

</body>
</html>
